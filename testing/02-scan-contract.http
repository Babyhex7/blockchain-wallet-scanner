###
# ðŸ“œ Contract Scanning Tests
# Endpoint: POST /api/v1/scan/contract
# Purpose: Test contract security scanning functionality
###

### Load environment variables
@baseUrl = http://localhost:3001
@apiVersion = v1
@apiUrl = {{baseUrl}}/api/{{apiVersion}}

###
# Test 1: Scan Verified Contract (Uniswap UNI Token)
# Expected: 200 OK dengan risk score rendah (10-30)
# Contract: Verified, well-known, legitimate
###
# @name scanUniswapContract
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "address": "0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",
  "chainId": 1
}

###
# Test 2: Scan Verified Contract (USDT Token)
# Expected: 200 OK dengan risk score rendah
# Contract: Tether USD, verified, widely used
###
# @name scanUSDTContract
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "address": "0xdAC17F958D2ee523a2206206994597C13D831ec7",
  "chainId": 1
}

###
# Test 3: Scan Proxy Contract (USDC)
# Expected: Proxy detection = true
# Contract: USDC menggunakan proxy pattern
###
# @name scanProxyContract
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "address": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
  "chainId": 1
}

###
# Test 4: Scan Contract dengan ChainId BSC
# Expected: 200 OK, menggunakan BSC RPC
###
# @name scanBSCContract
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "address": "0x0E09FaBB73Bd3Ade0a17ECC321fD13a19e81cE82",
  "chainId": 56
}

###
# Test 5: Invalid Address Format
# Expected: 400 Bad Request dengan error message
###
# @name invalidAddressFormat
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "address": "invalid_address_123",
  "chainId": 1
}

###
# Test 6: Missing Required Field (address)
# Expected: 400 Bad Request
###
# @name missingAddress
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "chainId": 1
}

###
# Test 7: Invalid ChainId
# Expected: 400 Bad Request
###
# @name invalidChainId
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "address": "0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",
  "chainId": 99999
}

###
# Test 8: Empty Address
# Expected: 400 Bad Request
###
# @name emptyAddress
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "address": "",
  "chainId": 1
}

###
# Test 9: Lowercase Address (should still work)
# Expected: 200 OK (addresses are case-insensitive)
###
# @name lowercaseAddress
POST {{apiUrl}}/scan/contract HTTP/1.1
Content-Type: application/json

{
  "address": "0x1f9840a85d5af5bf1d1762f925bdaddc4201f984",
  "chainId": 1
}

###
